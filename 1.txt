嗅觉浏览器规则分享，当前分享的是：网页小程序￥mini-program￥{"col_type":"movie_1_left_pic","interceptor":"","nextColType":"movie_1","nextRule":"","pages":"[{\"name\":\"海壳数据\",\"path\":\"hiker_cs_data\",\"rule\":\"{\\\"url\\\":\\\"https://api.f03d9.info/fyAll?limit=12&page=fypage\\\",\\\"search_url\\\":\\\"\\\",\\\"class_name\\\":\\\"主播&视频\\\",\\\"class_url\\\":\\\"anchor&library\\\",\\\"area_name\\\":\\\"\\\",\\\"area_url\\\":\\\"\\\",\\\"year_name\\\":\\\"\\\",\\\"year_url\\\":\\\"\\\",\\\"sort_name\\\":\\\"\\\",\\\"sort_url\\\":\\\"\\\",\\\"searchFind\\\":\\\"\\\",\\\"sdetail_find_rule\\\":\\\"\\\",\\\"sdetail_col_type\\\":\\\"movie_1\\\"}\"}]","preRule":"","rule":"js:\n// 头部分类构造器\nfunction hiker_ClassHeader(classArray) {\n    this.arr = classArray.map(v => this.init(v))\n    this.color = '#12b668'\n    this.boundary = 'blank_block'\n}\nhiker_ClassHeader.prototype = {\n    constructor: hiker_ClassHeader,\n    load(el) {\n        this.arr.forEach((v) => {\n            let { id, class_name, class_url } = v,\n            selected = JSON.stringify(this.getClass(id))\n            class_name.forEach((name, i) => {\n                let url = class_url[i],\n                    now = JSON.stringify({ name: name, url: url })\n                el.push({\n                    title: selected == now ? '““””' + name.fontcolor(this.color).bold() : name,\n                    url: selected == now ? 'hiker://empty' : $('#noLoading#').lazyRule((id, now) => {\n                        putMyVar('$hikerClassHeader_' + id, now)\n                        refreshPage(false)\n                        return 'hiker://empty'\n                    }, id, now),\n                    col_type: 'scroll_button'\n                })\n            })\n            el.push({ col_type: this.boundary })\n        })\n    },\n    init(classObject) {\n        classObject.class_name = classObject.class_name.split('&')\n        classObject.class_url = classObject.class_url.split('&').map((v) => v.trim())\n        return classObject\n    },\n    push(classObject) {\n        this.arr.push(this.init(classObject))\n    },\n    getClass(id) {\n        let defaultClass = this.arr.find(item => item.id == id)\n        defaultClass = JSON.stringify(defaultClass ? {\n            name: defaultClass.class_name[0],\n            url: defaultClass.class_url[0]\n        } : { name: 'cannot find id: ' + id + ' in hikerClassHeader', url: '' })\n        return JSON.parse(getMyVar('$hikerClassHeader_' + id, defaultClass))\n    },\n    setUrl(url) {\n        return url.replace(/\\$\\{([^}]*)\\}/g, (_, id) => this.getClass(id).url)\n    }\n}\n// 运行链接.js:\nfunction hiker_runCode(rule) {\n    try {\n        let [input, code] = rule.split('.js:')\n        return code ? eval(code) : rule\n    } catch (e) { return rule }\n}\n// 定义变量\nconst hiker_RULE = JSON.parse(JSON.parse(fetch('hiker://page/hiker_cs_data')).rule),\n    hiker_pageNum = parseInt(MY_URL.split('##')[2]),\n    hiker_fyAll = hiker_RULE.url.includes('fyAll')\nlet hiker_el = [],\n    hiker_URL = hiker_RULE.url.split(';'),\n    hikerHTML = '',\n    hiker_classHeader = []\n// 头部分类实例\nif (hiker_RULE.class_name) hiker_classHeader.push({\n    id: hiker_fyAll ? 'fyAll' : 'fyclass',\n    class_name: hiker_RULE.class_name,\n    class_url: hiker_RULE.class_url\n})\nif (hiker_RULE.area_name) hiker_classHeader.push({\n    id: hiker_fyAll ? 'fyAll' : 'fyarea',\n    class_name: hiker_RULE.area_name,\n    class_url: hiker_RULE.area_url\n})\nif (hiker_RULE.year_name) hiker_classHeader.push({\n    id: hiker_fyAll ? 'fyAll' : 'fyyear',\n    class_name: hiker_RULE.year_name,\n    class_url: hiker_RULE.year_url\n})\nif (hiker_RULE.sort_name) hiker_classHeader.push({\n    id: hiker_fyAll ? 'fyAll' : 'fysort',\n    class_name: hiker_RULE.sort_name,\n    class_url: hiker_RULE.sort_url\n})\nhiker_classHeader = new hiker_ClassHeader(hiker_classHeader)\n// 处理MY_URL\nMY_URL = hiker_URL.shift()\nMY_URL = hiker_classHeader.setUrl(hiker_fyAll ?\n        MY_URL.replace(/fyAll/g, '$${fyAll}') :\n        MY_URL.replace(/fy(class|area|year|sort)/g, '$${fy$1}'))\n    .replace(/fypage(?:@(-?\\d+)@)?(?:\\*(\\d+)@)?/g,\n        (_, start, space) => parseInt(start || 0) + 1 + (hiker_pageNum - 1) * parseInt(space || 1))\nMY_URL = /^([\\s\\S]*?)(?:\\[firstPage=([\\s\\S]*?)\\])?(?:(\\.js:[\\s\\S]*?))?$/.exec(MY_URL)\nif (hiker_pageNum == 1 && MY_URL[2]) MY_URL[1] = MY_URL[2]\nif (MY_URL[3] && !MY_URL[1].includes('.js:')) MY_URL[1] += MY_URL[3]\nMY_URL = hiker_runCode(MY_URL[1])\n// 处理MY_URL参数并获取HTML\nhiker_URL = {\n    method: hiker_URL[0] || 'get',\n    headers: { 'Content-Type': hiker_URL[1] ? 'text/plain;charst=' + hiker_URL[1] : null },\n    headerStr: hiker_URL[2]\n}\nif (/^post$/i.test(hiker_URL.method)) {\n    let [url, body] = MY_URL.split('?')\n    MY_URL = url.replace(/\\？\\？/g, '?')\n    if (body.startsWith('JsonBody=')) body = body.slice(9)\n    hiker_URL.body = body\n}\nif (hiker_URL.headerStr) hiker_URL.headerStr.match(/{(.*)}/)[1]\n    .split('&&').forEach((v) => {\n        let [key, value] = v.split('@')\n        hiker_URL.headers[key] = hiker_runCode(value)\n    })\ndelete hiker_URL.headerStr\nif (!hiker_URL.headers['User-Agent']) {\n    if (MY_RULE.ua == 'pc')\n        hiker_URL.headers['User-Agent'] = PC_UA\n    else if (MY_RULE.ua == 'mobile')\n        hiker_URL.headers['User-Agent'] = MOBILE_UA\n}\nhikerHTML = fetch(MY_URL, hiker_URL)\n// 劫持内置变量\ngetResCode = () => hikerHTML\nMY_RULE.class_url = hiker_classHeader.getClass(hiker_fyAll ? 'fyAll' : 'fyclass').url\nMY_RULE.area_url = hiker_fyAll ? MY_RULE.class_url : hiker_classHeader.getClass('fyarea').url\nMY_RULE.year_url = hiker_fyAll ? MY_RULE.class_url : hiker_classHeader.getClass('fyyear').url\nMY_RULE.sort_url = hiker_fyAll ? MY_RULE.class_url : hiker_classHeader.getClass('fysort').url\n// 生成头部分类及搜索功能\nif (MY_PAGE == 1) {\n    hiker_classHeader.load(hiker_el)\n    if (hiker_RULE.search_url) hiker_el.push({\n        title: \"搜索\",\n        desc: \"搜你想要的...\",\n        url: '\"hiker://search?s=\"+input',\n        extra: {\n            rules: $.toString(() => {\n                let rule = JSON.parse(fetch('hiker://home')).find((v) => v.title == MY_RULE.title),\n                    exRule = JSON.parse(JSON.parse(fetch('hiker://page/hiker_cs_data')).rule)\n                if (rule.nextRule) {\n                    rule.detail_find_rule = rule.nextRule\n                    rule.detail_col_type = rule.nextColType\n                }\n                return JSON.stringify([Object.assign(rule, exRule)])\n            }),\n            defaultValue: getMyVar('hiker_searchKey', ''),\n            onChange: \"putMyVar('hiker_searchKey',input)\"\n        },\n        col_type: \"input\",\n    })\n}\n// 劫持setResult\nsetResult = function(el, param1, param2, param3) {\n    param1 = CALLBACK_KEY\n    param2 = MY_RULE\n    param3 = MY_TYPE\n    if (Array.isArray(el.data)) el = el.data\n    el = hiker_el.concat(el)\n    method_setResult.invoke(javaContext, el, param1, param2, param3)\n}\nsetHomeResult = setResult\nsetSearchResult = setResult\n;// 原代码\n\nlet d = [];\nconst list_json = fetch(MY_URL);\nconst list = JSON.parse(list_json).data.data\nconst cdn = JSON.parse(list_json).cdn\n\nif (MY_URL.includes('library')) {\n  list.forEach(item => {\n    d.push({\n      title: item.title,\n      desc: item.subtitle,\n      pic_url: cdn.image+item.img_url,\n      url: $(\"https://sgpai.cc/play-details/1/\"+item.id).lazyRule(_ => {\n        const html = fetch(input)\n        return (html.match(/url:\"(.*?)index.m3u8\"/)[1]).replace(/\\\\u002F/g, '/')+\"index.m3u8\"\n      }),\n      col_type: 'movie_2'\n    })\n  })\n} \nelse {\n  list.forEach(item => {\n    item.cdn = cdn\n    d.push({\n      title: item.name,\n      desc: item.library_count+'部作品',\n      pic_url: cdn.image+item.img,\n      url: $(\"hiker://empty##fypage\").rule(item => {\n        let d = [];\n        const params = {\n          \"anchors_id\": item.id,\n          \"hm\": \"008-api\",\n          \"length\": 12,\n          \"page\": MY_URL.split('##')[1],\n        }\n        const headers = {\n          'Content-Type': 'application/json',\n          'Referer': 'http://shuiguopai.com/',\n          'User-Agent': MOBILE_UA\n        }\n        const data_json = fetch(\"https://api.cbbee0.com/v1_2/anchorsDetail\", {headers: headers, method:'POST', body: JSON.stringify(params)})\n        const list = JSON.parse(data_json).data.list\n        list.forEach(res => {\n          d.push({\n            title: res.title,\n            desc: res.subtitle,\n            pic_url: res.img_url,\n            url: $(\"https://sgpai.cc/play-details/1/\"+res.library_id+\"/\").lazyRule(_ => {\n              const html = fetch(input)\n              return (html.match(/url:\"(.*?)index.m3u8\"/)[1]).replace(/\\\\u002F/g, '/')+\"index.m3u8\"\n            }),\n            col_type: 'movie_2'\n          })\n        })\n        setResult(d);\n      }, item),\n      col_type: 'icon_round_4'\n    })\n  })\n}\nsetResult(d);","title":"水果派3.0","ua":"pc","url":"hiker://empty##https://api.f03d9.info/##fypage"}